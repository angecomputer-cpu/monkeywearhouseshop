<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monkey Warehouse - Official Shop</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        :root { 
            --main-bg: #0a0a0a; 
            --card-bg: #151515; 
            --accent: #ffd32a; /* IL GIALLO MONKEY CORRETTO */
        }
        body { font-family: 'Inter', sans-serif; background: var(--main-bg); color: white; margin: 0; }
        
        /* HEADER FIX CON .JPG */
        header { 
            height: 60vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('header.jpg'); 
            background-size: cover; 
            background-position: center;
            border-bottom: 4px solid var(--accent);
            text-align: center;
        }

        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; padding: 40px; max-width: 1400px; margin: 0 auto; }
        
        .product-card { background: var(--card-bg); border-radius: 20px; overflow: hidden; border: 1px solid #222; transition: 0.3s; }
        .product-card:hover { border-color: var(--accent); transform: scale(1.02); }

        /* CAROSELLO OTTIMIZZATO PER FOTO VERTICALI */
        .slider { 
            width: 100%; 
            aspect-ratio: 4/5; 
            overflow: hidden; 
            position: relative; 
            background: #000;
        }
        .slider img { 
            width: 100%; 
            height: 100%; 
            object-fit: contain; 
            display: none; 
            position: absolute;
            transition: opacity 0.8s ease-in-out;
        }
        /* Sfumatura di profondità sui lati */
        .slider::before {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(255,211,42,0.03) 0%, rgba(0,0,0,0.7) 100%);
            z-index: 1;
            pointer-events: none;
        }
        .slider img.active { display: block; }

        .info { padding: 25px; text-align: left; }
        h2 { margin: 0; color: var(--accent); font-size: 1.5rem; text-transform: uppercase; letter-spacing: 1px; }
        .price { font-size: 2.2rem; font-weight: 900; margin: 10px 0; color: white; }
        .desc { color: #888; font-size: 0.95rem; margin-bottom: 20px; min-height: 45px; line-height: 1.4; }
        
        .btn { 
            display: block; 
            text-align: center;
            padding: 15px; 
            background: var(--accent); 
            color: black; 
            text-decoration: none; 
            border-radius: 12px; 
            font-weight: 800;
            text-transform: uppercase;
            transition: 0.3s;
        }
        .btn:hover { background: white; transform: translateY(-2px); }
    </style>
</head>
<body>

    <header>
        <img src="logo_white.png" alt="Logo" style="max-width: 180px; margin-bottom: 20px;">
        <h1 style="font-size: 3.5rem; margin: 0; letter-spacing: -2px;">MONKEY WAREHOUSE</h1>
    </header>

    <div id="shop-grid" class="grid">Caricamento prodotti...</div>

    <script>
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTEhTrbEm6y5Bl67WK0wDCbkQLoUUx-VV9n-0KFhhsY6tJjpPKm_iMuxnS2H3neRU7RxbRw8RDoMTSE/pub?output=csv';
        const GITHUB_USER = 'angecomputer-cpu';
        const GITHUB_REPO = 'monkeywearhouseshop';

        async function init() {
            try {
                Papa.parse(CSV_URL, {
                    download: true, header: true,
                    complete: async (results) => {
                        const container = document.getElementById('shop-grid');
                        container.innerHTML = '';
                        for (let p of results.data) {
                            if (!p.id || !p.cartella_foto) continue;
                            const res = await fetch(`https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/img/${p.cartella_foto}`);
                            const files = await res.json();
                            let imgs = '';
                            let found = false;
                            files.forEach((f, i) => {
                                if (f.name.match(/\.(jpg|jpeg|png|webp)$/i)) {
                                    imgs += `<img src="${f.download_url}" class="${!found ? 'active' : ''}">`;
                                    found = true;
                                }
                            });
                            container.innerHTML += `
                                <div class="product-card">
                                    <div class="slider" id="s-${p.id}">${imgs}</div>
                                    <div class="info">
                                        <h2>${p.nome}</h2>
                                        <div class="price">${p.prezzo}€</div>
                                        <p class="desc">${p.descrizione}</p>
                                        <a href="${p.link_paypal}" class="btn" target="_blank">ORDINA ORA</a>
                                    </div>
                                </div>`;
                            startSlider(`s-${p.id}`);
                        }
                    }
                });
            } catch (e) { console.error("Errore Shop:", e); }
        }

        function startSlider(id) {
            let curr = 0;
            const container = document.getElementById(id);
            const imgs = container.querySelectorAll('img');
            if (imgs.length < 2) return;
            setInterval(() => {
                imgs[curr].classList.remove('active');
                curr = (curr + 1) % imgs.length;
                imgs[curr].classList.add('active');
            }, 3500);
        }
        init();
    </script>
</body>
</html>
